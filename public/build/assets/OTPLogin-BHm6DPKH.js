import{r as i,W as v,j as e,Y as y,a as T}from"./app-DM-y8oy4.js";import{u as P,G as O}from"./GuestLayout-APHH3p4T.js";import{B as p}from"./button-DBOqfNRQ.js";import{D as C,a as D,b as E,g as I,h as S}from"./dropdown-menu-T5Wq_gIh.js";import{I as R,a as f,b as a,c as L}from"./input-otp-CdzLVq_K.js";import{C as k}from"./chevron-left-D5q40Jtd.js";import"./toast-CVRs_JVZ.js";import"./index-BXrqN9aj.js";import"./card-BvaaXfYT.js";import"./index-PHw5nAXF.js";import"./Combination-DVLYXFxg.js";import"./index-Cc1j9ehy.js";import"./index-_zI8gevu.js";import"./createLucideIcon-c5AOdRZc.js";function K({status:M}){const{toast:r}=P(),[l,h]=i.useState("+60"),[s,u]=i.useState("sendOTP"),[n,d]=i.useState(30),{data:o,setData:c,post:j,processing:b,errors:g,reset:x}=v({action:s,prefix:l,phone:"",otp:""});i.useEffect(()=>{c("action",s)},[s]),i.useEffect(()=>{if(s==="verifyOTP"&&n>0){const t=setTimeout(()=>d(n-1),1e3);return()=>clearTimeout(t)}},[n,s]),i.useEffect(()=>{o.otp.length===6&&m(new Event("submit"))},[o.otp]);const m=t=>{t==null||t.preventDefault(),j(route("login"),{onError:()=>{r({variant:"destructive",duration:5e3,description:e.jsx("div",{className:"text-white font-semibold",children:s==="sendOTP"?"Invalid Phone Number":"Invalid OTP"}),className:"m-auto w-fit rounded-xl flex items-center justify-center px-3 py-2.5"})},onSuccess:()=>{s==="sendOTP"?(u("verifyOTP"),d(30),g.phone=""):x("phone"),r({duration:5e3,description:e.jsx("div",{className:"text-white font-semibold",children:s==="sendOTP"?"OTP Send":"Valid OTP"}),className:"m-auto w-fit rounded-xl flex items-center justify-center px-3 py-2.5 bg-green-400",open:!0})}})},N=async()=>{try{const t=await T.post(route("resendOTP"),{action:o.action,prefix:o.prefix,phone:o.phone});r({duration:5e3,description:e.jsx("div",{className:"text-white font-semibold",children:"OTP Resend"}),className:"m-auto w-fit rounded-xl flex items-center justify-center px-3 py-2.5 bg-green-400"}),d(30)}catch{r({variant:"destructive",duration:5e3,description:e.jsx("div",{className:"text-white font-semibold",children:"Failed to resend OTP"}),className:"m-auto w-fit rounded-xl flex items-center justify-center px-3 py-2.5"})}};return e.jsxs(O,{children:[e.jsx(y,{title:"Log in"}),e.jsx("div",{className:"h-56",children:e.jsxs("form",{onSubmit:m,className:"h-full flex flex-col justify-between",children:[s==="verifyOTP"&&e.jsx("span",{className:"absolute top-6 left-6 p-1 rounded-lg flex items-center bg-black bg-opacity-10 fade-in-out cursor-pointer",onClick:async t=>{t.preventDefault(),u("sendOTP"),x("otp")},children:e.jsx(k,{className:"size-6 text-gray-700"})}),s==="sendOTP"?e.jsxs("div",{className:"size-full text-center fade-in-out",children:[e.jsxs("div",{className:"h-1/2 flex flex-col justify-center",children:[e.jsx("h2",{className:"text-base font-bold",children:"Login / Sign Up"}),e.jsx("p",{className:"text-sm text-neutral-600",children:"by entering your phone number"})]}),e.jsxs("div",{className:"h-1/2 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex h-12 w-full p-1 gap-1 rounded-xl border border-input bg-white bg-transparent shadow-sm",children:[e.jsxs(C,{children:[e.jsx(D,{asChild:!0,className:"h-full p-2 text-lg font-mono tracking-wider rounded-lg",disabled:!0,children:e.jsx(p,{variant:"outline",children:l})}),e.jsx(E,{children:e.jsx(I,{value:l,onValueChange:h,children:e.jsx(S,{value:"+60",children:"+60"})})})]}),e.jsx("input",{type:"tel",className:"flex font-mono size-full border-none rounded-lg px-3 py-1 text-base font-semibold tracking-[0.4em] placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-0",name:"phone",value:o.phone,autoComplete:"phone",placeholder:"1234567890",maxLength:11,onChange:t=>{const w=t.target.value.replace(/\D/g,"");c("phone",w)}})]}),e.jsx("p",{})]})]}):e.jsxs("div",{className:"size-full text-center fade-in-out",children:[e.jsxs("div",{className:"h-1/2 flex flex-col justify-center",children:[e.jsx("h2",{className:"text-base font-bold",children:"Enter OTP"}),e.jsx("p",{className:"text-xs text-nowrap text-neutral-600",children:"Enter the OTP sent to your phone number"})]}),e.jsxs("div",{className:"h-1/2 gap-1 pb-6 flex flex-col justify-evenly items-center text-lg",children:[e.jsxs(R,{maxLength:6,autoFocus:!0,value:o.otp,onInput:t=>{c("otp",t.target.value)},autoComplete:"one-time-code",children:[e.jsxs(f,{children:[e.jsx(a,{index:0,className:"font-mono bg-white"}),e.jsx(a,{index:1,className:"font-mono bg-white"}),e.jsx(a,{index:2,className:"font-mono bg-white"})]}),e.jsx(L,{}),e.jsxs(f,{children:[e.jsx(a,{index:3,className:"font-mono bg-white"}),e.jsx(a,{index:4,className:"font-mono bg-white"}),e.jsx(a,{index:5,className:"font-mono bg-white"})]})]}),e.jsxs("div",{className:"h-4 w-full px-4 flex items-center justify-between text-xs text-gray-600",children:[e.jsx("p",{children:"Did not get OTP?"}),e.jsxs("button",{tabIndex:-1,type:"button",onClick:t=>{t.preventDefault(),n===0&&N()},disabled:n!==0,className:`p-0 h-fit text-xs bg-transparent shadow-none ${n===0?"text-blue-500":"text-gray-400 cursor-not-allowed"}`,children:["Resend",n!==0&&` in ${n} seconds`]})]}),e.jsx("p",{})]})]}),e.jsx("div",{className:"w-full flex items-center",children:e.jsx(p,{className:"h-12 w-full rounded-2xl font-mono",disabled:b,children:s==="sendOTP"?"NEXT":"VERIFY"})})]})})]})}export{K as default};
